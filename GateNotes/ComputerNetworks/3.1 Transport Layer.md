
#### 1 Transport Layer
- **Where in the TCP/IP stack does this layer reside?**
	- This layer is between the application layer and network layer
- **Role of TCP layer with Analogy**
	- This layer provides a logical connection between two applications running on different hosts
	- The two different hosts(using application layer protocols) is not concerned about how the messages are sent to the other host
		- This is similar to you sending a post to another person. 
			- You add the destination address to the post and put it in a mail box
		- The post man collects all the posts from a mail box and gives it to the post office
		- The post office will perform the necessary actions to deliver the post reliably to the nearest post office at the destination
		- The postman then delivers the post to each person
		- In this case 
			- You sending the post are the application layer
				- There are many people using the post which is similar to many applications running on a single host 
			- The post man is analogous to the TCP Layer
				- They are not concerned how the post reaches the destination city (post office will be responsible for this)
				- They deliver each post to the correct person from the destination post office
			- The post office is similar to the Network layer
				- It connect both the sender's and receiver's cities
				- Here the cities are the host machines
- **What Happens an application sends a message?**
	- An application sends a message to another application on a different host
		- There can be many applications sending a message in the same host 
	- This message is broken into pieces and TCP headers are added
		- Each piece with its headers are known as **segments**
	- This segment travels through the network
		- The TCP layer is also not concerned about how the message reaches the other host
	- In the destination host the network layer extracts the TCP segment from the packets
	- The TCP layer 
		- Combines all the segments and delivers the message to the correct application at the destination host 
		- **Does the TCP layer directly deliver the message to the application?**
			- No
			- Explained in next section [[#2 Transport layer multiplexing and demultiplexing]]


#### 2 Transport layer multiplexing and demultiplexing
- **What is demultiplexing?**
	- Process in which TCP layer sends the message to the correct socket
		- As mentioned earlier the TCP layer does not send the message to an application
		- Instead it sends the message to the socket that is associated with the application
- **What is multiplexing**
	- Process in which TCP layer 
		- Gathers messages from different sockets that are associated with applications 
		- Segments each message with appropriate headers
		- Sends the segments through the network
- **How does the TCP layer distinguish between sockets?**
	- Each socket is identified using a unique 16-bit port number with the range \[0, 65535]
	- The source and destination port number is added to the segment while multiplexing
- **Connectionless de/multiplexing**
	- UDP uses this 
	- A socket is identified by a two element tuple
		- Destination IP addr
		- Destination port
	- This means when two segments are sent with the same destination IP addr and destination socket: 
		- At the destination both segments are collected from the same destination socket even if the source addr and ports are different
- **Connection Oriented de/multiplexing**
	- TCP uses this
	- A socket is identified by 4 tuple
		- Source IP addr
		- Source port
		- Destination addr
		- Destination port
	- This means when two application send a request with different IP addr: 
		- At the destination a different socket is used for each tuple that has different source addr and/or port

#### 3 UDP
- UDP is 
	- Connectionless
		- Unlike TCP, UDP does not have a handshake protocol before exchanging messages
	- lightweight
		- The UDP layer adds only the source and destination port address
	- Fast
		- There is no handshaking unlike TCP
			- The DNS uses UDP because UDP is faster compared to TCP
		- Unlike TCP there is no congestion control
			- This is useful in SNMP protocol to send messages when network congestion is high
	- **Drawback:**
		- UDP can keep sending datagrams even if the network is congested, this limits the rates for TCP connections
	- Unreliable
		- UDP does not guarantee the delivery of the message 
		- UDP does not guarantee that no duplicate messages were sent to destination
- UDP data segment structure
	- [RFC768](https://datatracker.ietf.org/doc/html/rfc768/)